##################
#                #
#     simple     #
#   .tmux.conf   #
#    chiaretto   #
#                #
##################

######################## Good practice ##########################
#   set  --> set-option											#
#   setw --> set-window-option									#
#   run  --> run-shell											#
#   bind --> bind-key											#
#       -r flag: enable keep hitting bind key without prefix	#
#       -n flag: enable bind key without prefix					#
#       -g flag: global											#
#################################################################

######### Choose your own colours ##########
# for i in {0..255} ; do                   #
#    printf "\x1b[38;5;${i}mcolour${i}\n"; #
# done                                     #
############################################

# Changing C-b to C-a
unbind C-b
set -g prefix C-s
bind C-a send-prefix

# Exit when press ESC (changed from 500ms do 0)
set -sg escape-time 0

# Change tmux term from screen to screen-256color
set -g default-terminal "xterm-256color"

# Do not exit when close session and another exists
set-option -g detach-on-destroy off

# When a smaller terminal connects to a tmux client, it shrinks to fit it.
setw -g aggressive-resize on

# Split panes using | and -
bind -n C-\ split-window -h -c "#{pane_current_path}"
bind \ split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"
unbind '"'
unbind %

# Rename Session
unbind '.'
bind . command-prompt "rename-session '%%'"

# Rename Window
unbind ','
bind , command-prompt "rename-window '%%'"

# Create new session
unbind n
bind n command-prompt "new-session -s '%%' -c '#{pane_current_path}'"

# Auto rename
setw -g automatic-rename on
setw -g automatic-rename-format '#{pane_title}'
bind -n C-t new-window -c "#{pane_current_path}"

# Sync panes on/off
bind a set-window-option synchronize-panes

# Switch Windows (Shift + Arrow keys)
bind -n S-right next-window
bind -n S-left previous-window

# Pane colours
set -g window-style 'fg=colour250,bg=colour237'
set -g window-active-style 'fg=colour250,bg=black'
set -g pane-border-fg colour237
set -g pane-active-border-bg colour250
set -g pane-active-border-fg colour237
set -g pane-active-border-style "bg=colour237, fg=colour223"
set -g pane-border-style "bg=colour237, fg=colour223"
# set -g pane-border-format " #{pane_title} "
# set -g pane-border-status top

# message infos
set -g message-bg colour237
set -g message-fg colour223

# writting commands inactive
set -g message-command-bg colour237
set -g message-command-fg colour223

# pane number display
set -g display-panes-active-colour colour250
set -g display-panes-colour colour237

# clock
set-window-option -g clock-mode-colour colour223

# Window mode as VI
set-window-option -g mode-keys vi

# Switch panes (Ctrl + Arrow keys)
bind -n C-Left select-pane -L
bind -n C-Right select-pane -R
bind -n C-Up select-pane -U
bind -n C-Down select-pane -D

# Switch panes using Alt-arrow without prefix (MAC)
#bind -n M-Left select-pane -L
#bind -n M-Right select-pane -R
#bind -n M-Up select-pane -U
#bind -n M-Down select-pane -D

# Switch Sessions (Alt + Arrow keys)
bind -n M-right  switch-client -n
bind -n M-Left  switch-client -p
bind -n M-l  switch-client -l

# Change panel orders (Ctrl + Shift + Arrow keys)
bind -n C-S-Left swap-window -t -1
bind -n C-S-Right swap-window -t +1

# Resizing panel (Alt + Shift + Arrow keys)
bind -n M-S-Left resize-pane -L
bind -n M-S-Right resize-pane -R
bind -n M-S-Up resize-pane -U
bind -n M-S-Down resize-pane -D

# Quiet mode
set -g visual-activity off
set -g visual-bell off
set -g visual-silence off
set -g bell-action none
set -g monitor-activity off

# The statusbar 
# default statusbar colors
set -g status-bg colour237
set -g status-fg colour223

# default window title colors
set -g window-status-bg colour237
set -g window-status-fg colour237

set -g window-status-activity-bg colour237
set -g window-status-activity-fg colour248

# active window title colors
set -g window-status-current-bg colour237
set -g window-status-current-fg colour237

set -g status-position bottom
set -g status-left-length 50
set -g status-left "#[fg=colour223, bg=colour237][#[fg=colour142, bg=colour237]#S#[fg=colour223, bg=colour237]] #[fg=colour223, bg=colour237, nobold, noitalics, nounderscore]| "
set -g status-right "#[fg=colour223, bg=colour237] [#(TZ=America/Sao_Paulo date '+%%d-%%m-%%Y %%H:%%M')]"

set -g window-status-current-format '#[fg=colour214, bg=colour237, nobold, noitalics, nounderscore]#W#[fg=colour223, bg=colour237, nobold, noitalics, nounderscore] |'
set -g window-status-format '#[fg=colour223, bg=colour237, nobold, noitalics, nounderscore]#W#[fg=colour223, bg=colour237, nobold, noitalics, nounderscore] |'

# Color when select with mouse
set -wg mode-style bg=colour237,fg=colour214

# Enable mouse selection
set -g mouse on

# Paste
bind -T root MouseDown2Pane run -b "tmux paste-buffer"
bind -T root C-v run -b "tmux paste-buffer"

# Reverse search on terminal
bind -n C-f copy-mode \; send-keys ?

# Choose which buffer to paste from
bind b if 'test -n "$(tmux list-buffer)"' \
  "choose-buffer -F \"#{=120:buffer_sample}\" -O name \; send-keys Up" \
  "display-message 'Buffer is empty'"

# Boost history
set -g history-limit 10000

# Reload tmux config
bind r source-file ~/.tmux.conf \; display-message "tmux.conf reloaded."

# Change format choose-tree 
bind -r w choose-tree -w -F '#{window_name}'
bind -r s choose-session -F '#{window_name}'

# Bind k to kill-window
bind k confirm kill-window

# Install plugins 
# Run 'git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm'
# before install plugins
set -g @plugin 'tmux-plugins/tmux-resurrect'

# Ressurect SSH connections (used with ssh keys)
set -g @resurrect-processes 'ssh'

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'
run '~/.tmux/plugins/tmux-resurrect/resurrect.tmux'
